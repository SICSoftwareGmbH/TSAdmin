<h2>Add a new rule</h2>
<div class="action-box">
  <form action="/add" method="post">
    From <input type="text" name="from" value="http://" /> to <input type="text" name="to" value="http://" />
    <br />
    Type
    <select name="type">
      <option selected="selected" value="map">Mapping (hide the internal server)</option>
      <option value="redirect">Simple 301-Redirect</option>
    </select>
    <input type="submit" name="send" value="Add this rule" />
  </form>
</div>

<?r
# TODO: Refactor to helper
def format_url(uri)
  schema = (uri =~ /^https/) ? "https" : "http"
  '<span class="'+schema+'">'+schema+'</span>:'+(schema == "http" ? uri[5..-1] : uri[6..-1])
end
?>

<h2>Mappings</h2>
<?r @ts.maps.each_with_index do |map, i| ?>
<div class="rule">
  <a href="/delete?type=map&id=#{i}">delete</a>
  <strong>#{format_url(map[:from])}</strong> <small>maps to</small> <strong>#{format_url(map[:to])}</strong>
</div>
<?r end ?>

<h2>301 Redirects</h2>
<?r @ts.redirects.each_with_index do |redirect, i| ?>
<div class="rule">
  <a href="/delete?type=redirect&id=#{i}">delete</a>
  <strong>#{format_url(redirect[:from])}</strong> <small>redirects to</small> <strong>#{format_url(redirect[:to])}</strong>
</div>
<?r end ?>

